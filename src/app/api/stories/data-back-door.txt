lvl050

Have you ever wondered how an offline spreadsheet gets vetted when you click the submit button? The answer won't surprise you! After all, you're here... on my stories page.

I was one of two people in charge of spreadsheet form submittals for our company. We had a file that would print the spreadsheet off for our users. They would fill it out while they were out-and-about without the internet. Then, when they came back to their office they would hit the "submit" button and the data would be shot off to our endpoint.

Our deliciously undefended endpoint => I'm exaggerating for dramatic effect.

We had type validation and string key verification in place based on the payload. BUT.... if you had the correct string pointers in row 1 we would begin the process. Specifically, we would take the submitted form data and move it into a temporary DB table. We did this because you weren't allowed to pass form data through the firewall as a general rule. But, one would say, are you not receiving the request on the other side of said firewall? No, we were not. This endpoint had an exemption from the firewalls protection. It was a landing pad specifically for the form data that we received from our spreadsheets. We had no rules that stopped us from connecting to our MSSQL instance at this point b/c the request existed on our servers. So, into the table the data went and we then formed a new http request that included the id tag for the uploaded information and sent that to our processing page. On our processing page we would take the ID, and unload all of our data into our system.

At this point we would run the data through a rigorous check system like "is this a string?" and "is this a number?" Once we were sure the data was safe we loaded it all into an html form... yes, an actual html form on our backend... that was a duplicate of another form that existed in the system for performing this same operation. Then we submitted the form data to the page that built the form (b/c legacy) where it was actually unpacked, checked again, and then, finally, added to the database.

